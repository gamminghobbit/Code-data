---
title: "Client Report - BYU-Idaho Players and Comparing Teams"
subtitle: "Unit 2 Task 2"
author: "William Hardy"
format:
  html:
    self-contained: true
    page-layout: full
    title-block-banner: true
    toc: true
    toc-depth: 3
    toc-location: body
    number-sections: false
    html-math-method: katex
    code-fold: true
    code-summary: "Show the code"
    code-overflow: wrap
    code-copy: hover
    code-tools:
        source: false
        toggle: true
        caption: See code
execute: 
  warning: false
    
---

```{python}
import pandas as pd 
import numpy as np
import sqlite3
from lets_plot import *

LetsPlot.setup_html(isolated_frame=True)
```


```{python}
# Learn morea about Code Cells: https://quarto.org/docs/reference/cells/cells-jupyter.html

# Include and execute your code here
sqlite_file = 'lahmansbaseballdb.sqlite'
# this file must be in the same location as your .qmd or .py file
con = sqlite3.connect(sqlite_file)
```

## QUESTION 1

__Write an SQL query to create a new dataframe about baseball players who attended BYU-Idaho. The new table should contain five columns: playerID, schoolID, salary, and the yearID/teamID associated with each salary. Order the table by salary (highest to lowest) and print out the table in your report.__

_type your results and analysis here_

```{python}
query1 = """
SELECT cp.playerID, cp.schoolID, sal.salary, sal.yearID, sal.teamID
FROM CollegePlaying cp
JOIN Salaries sal ON cp.playerID = sal.playerID
WHERE cp.schoolID = 'idahofalls'
ORDER BY sal.salary DESC;
"""
byu_idaho_players = pd.read_sql_query(query1, con)
byu_idaho_players

```

## QUESTION 2

__Pick any two baseball teams and compare them using a metric of your choice (average salary, home runs, number of wins, etc). Be creative! Write an SQL query to get the data you need, then make a graph using Lets-Plot to visualize the comparison. What do you learn?__ 

_type your results and analysis here_

```{python}
query2 = """
SELECT teamID, yearID, SUM(HR) AS total_HR
FROM Batting
WHERE teamID IN ('NYA', 'BOS') AND yearID >= 2000
GROUP BY teamID, yearID
ORDER BY yearID, teamID;
"""
team_hr = pd.read_sql_query(query2, con)
team_hr

ggplot(team_hr, aes(x='yearID', y='total_HR', color='teamID')) + \
    geom_line(size=2) + \
    ggtitle("Total Home Runs Per Year (2000â€“Present): NYA vs BOS") + \
    xlab("Year") + ylab("Total HR") + \
    theme_minimal()
```